<!DOCTYPE html><html lang="en"><title>React 容器组件 - OS</title><meta charset="utf-8"><meta name="description"content="React 容器组件"><meta name="keywords"><meta name="subtitle"content="Code &amp; Life"><meta name="author"content="zowiegong"><meta name="language"content="zh-CN"><meta name="timezone"content="Asia/Shanghai"><meta name="viewport"content="width=device-width,initial-scale=1"><link href="/manifest.json"rel="manifest"><link href="/atom.xml"rel="alternate"type="application/atom+xml"><link href="/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="/css/style.css"rel="stylesheet"><link href="/css/post.css"rel="stylesheet"><meta name="generator"content="Hexo 4.2.0"><header id="header-container"><h1 id="blog-title"><a href="/">OS</a></h1><nav><ul class="menu-list"><li class="menu-list-item"><a href="/categories"class="menu-name">categories</a><li class="menu-list-item"><a href="/tags"class="menu-name">tags</a><li class="menu-list-item"><a href="/about"class="menu-name">about</a></ul></nav></header><article class="main"><h1 id="post-title">React 容器组件</h1><div class="post-info"><time class="post-date">2018-05-27</time><ul class="tag-list"><li class="tag-item"><a href="/tags/react/"class="tag-name">#react</a></ul></div><section class="markdown-body"><h2><a href="#%E5%AE%B9%E5%99%A8%E7%BB%84%E4%BB%B6-container-component"class="anchor"aria-hidden="true"id="user-content-容器组件-container-component"><span class="octicon octicon-link"aria-hidden="true"></span></a>容器组件 (container component)</h2><blockquote><p>A container does data fetching and then renders its corresponding sub-component. That’s it.</blockquote><p>一个容器组件仅应该用来获取数据并渲染相应的子组件。<p>容器组件与所渲染的子组件的关系如下<pre><code>StockWidgetContainer =&gt; StockWidget
TagCloudContainer =&gt; TagCloud
PartyPooperListContainer =&gt; PartyPooperList
</code></pre><h3><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%AE%B9%E5%99%A8%E7%BB%84%E4%BB%B6"class="anchor"aria-hidden="true"id="user-content-为什么需要容器组件"><span class="octicon octicon-link"aria-hidden="true"></span></a>为什么需要容器组件</h3><p>一个用来显示评论的组件，在不使用容器组件的情况：<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">CommentList</span> <span class="pl-k">extends</span> <span class="pl-e">React</span>.<span class="pl-smi">Component</span> {
  <span class="pl-c1">this</span>.<span class="pl-smi">state</span> <span class="pl-k">=</span> { comments<span class="pl-k">:</span> [] };

  <span class="pl-en">componentDidMount</span>() {
    <span class="pl-en">fetchSomeComments</span>(<span class="pl-smi">comments</span> <span class="pl-k">=&gt;</span>
      <span class="pl-c1">this</span>.<span class="pl-en">setState</span>({ comments<span class="pl-k">:</span> comments }));
  }
  <span class="pl-en">render</span>() {
    <span class="pl-k">return</span> (
      <span class="pl-k">&lt;</span>ul<span class="pl-k">&gt;</span>
        {<span class="pl-c1">this</span>.<span class="pl-smi">state</span>.<span class="pl-smi">comments</span>.<span class="pl-en">map</span>(<span class="pl-smi">c</span> <span class="pl-k">=&gt;</span> (
          <span class="pl-k">&lt;</span>li<span class="pl-k">&gt;</span>{<span class="pl-smi">c</span>.<span class="pl-c1">body</span>}—{<span class="pl-smi">c</span>.<span class="pl-smi">author</span>}<span class="pl-k">&lt;</span><span class="pl-k">/</span>li<span class="pl-k">&gt;</span>
        ))}
      <span class="pl-k">&lt;</span><span class="pl-k">/</span>ul<span class="pl-k">&gt;</span>
    );
  }
}</pre></div><p>除非情况完全相同，否则<code>CommentList</code>不能被重用。<h3><a href="#%E4%BD%BF%E7%94%A8%E5%AE%B9%E5%99%A8%E7%BB%84%E4%BB%B6"class="anchor"aria-hidden="true"id="user-content-使用容器组件"><span class="octicon octicon-link"aria-hidden="true"></span></a>使用容器组件</h3><p>CommentListContainer<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">CommentListContainer</span> <span class="pl-k">extends</span> <span class="pl-e">React</span>.<span class="pl-smi">Component</span> {
  state <span class="pl-k">=</span> { comments<span class="pl-k">:</span> [] };
  <span class="pl-en">componentDidMount</span>() {
    <span class="pl-en">fetchSomeComments</span>(<span class="pl-smi">comments</span> <span class="pl-k">=&gt;</span>
      <span class="pl-c1">this</span>.<span class="pl-en">setState</span>({ comments<span class="pl-k">:</span> comments }));
  }
  <span class="pl-en">render</span>() {
    <span class="pl-k">return</span> <span class="pl-k">&lt;</span>CommentList comments<span class="pl-k">=</span>{<span class="pl-c1">this</span>.<span class="pl-smi">state</span>.<span class="pl-smi">comments</span>} <span class="pl-k">/</span><span class="pl-k">&gt;</span>;
  }
}</pre></div><p>CommentList<div class="highlight highlight-source-js"><pre><span class="pl-k">const</span> <span class="pl-c1">CommentList</span> <span class="pl-k">=</span> <span class="pl-smi">props</span> <span class="pl-k">=&gt;</span>
  <span class="pl-k">&lt;</span>ul<span class="pl-k">&gt;</span>
    {<span class="pl-smi">props</span>.<span class="pl-smi">comments</span>.<span class="pl-en">map</span>(<span class="pl-smi">c</span> <span class="pl-k">=&gt;</span> (
      <span class="pl-k">&lt;</span>li<span class="pl-k">&gt;</span>{<span class="pl-smi">c</span>.<span class="pl-c1">body</span>}—{<span class="pl-smi">c</span>.<span class="pl-smi">author</span>}<span class="pl-k">&lt;</span><span class="pl-k">/</span>li<span class="pl-k">&gt;</span>
    ))}
  <span class="pl-k">&lt;</span><span class="pl-k">/</span>ul<span class="pl-k">&gt;</span></pre></div><p>使用了容器组件，有如下好处<ol><li>将获取数据与展示数据分离，增强代码灵活程度与可阅读性。<li><code>CommentList</code>很容易被重用。</ol><h3></h3><p>相关文章：<ul><li><a href="https://medium.com/@learnreact/container-components-c0e67432e005"target="_blank"rel="nofollow noopener">Container Components</a><li><a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0"target="_blank"rel="nofollow noopener">Presentational and Container Components</a></ul></section></article><footer class="footer-container"><section>Copyright &copy; 2020&nbsp;<a href="mailto:zowiegong@gmail.com">zowiegong</a>&nbsp;Powered by&nbsp;<a href="https://github.com/hexojs/hexo"target="_blank"rel="noopener noreferrer">Hexo</a>&nbsp;Theme by&nbsp;<a href="https://github.com/zowiegong/hexo-theme-os"target="_blank"rel="noopener noreferrer">OS.</a><br><a href="https://github.com/zowiegong/hexo-blog/edit/master/source/_posts/React-container.md"target="_blank">Edit source file</a></section></footer><div class="hover-pointer"id="scroll-to-top-container"><svg class="hover-fill"height="3rem "id="scroll-to-top-btn"version="1.1"viewBox="0 0 1024 1024"width="3rem"><path d="M825.568 555.328l-287.392-289.28C531.808 259.648 523.488 256.576 515.2 256.64 514.08 256.544 513.12 256 512 256c-4.672 0-9.024 1.088-13.024 2.88-4.032 1.536-7.872 3.872-11.136 7.136l-259.328 258.88c-12.512 12.48-12.544 32.736-0.032 45.248 6.24 6.272 14.432 9.408 22.656 9.408 8.192 0 16.352-3.136 22.624-9.344L480 364.288 480 928c0 17.696 14.336 32 32 32s32-14.304 32-32L544 362.72l236.192 237.728c6.24 6.272 14.496 9.44 22.688 9.44s16.32-3.104 22.56-9.312C838.016 588.128 838.048 567.84 825.568 555.328z"p-id="1100"></path><path d="M864 192 160 192C142.336 192 128 177.664 128 160s14.336-32 32-32l704 0c17.696 0 32 14.336 32 32S881.696 192 864 192z"p-id="1101"></path></svg></div><script>let pluginsConfig = JSON.parse('{"googleAnalytics":"UA-121105508-1","scrollToTop":true,"scrollSmooth":false,"comments":{"enable":true,"repo":"zowiegong/hexo-blog"}}')</script><script>pluginsConfig.comments.enable = true</script><script src="/js/script.js"></script>