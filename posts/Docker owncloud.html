<!DOCTYPE html><html lang="en"><title>Docker 安装 ownCloud - OS</title><meta charset="utf-8"><meta name="description"content="Docker 安装 ownCloud"><meta name="keywords"><meta name="subtitle"content="Code &amp; Life"><meta name="author"content="zowiegong"><meta name="language"content="zh-CN"><meta name="timezone"content="Asia/Shanghai"><meta name="viewport"content="width=device-width,initial-scale=1"><link href="/manifest.json"rel="manifest"><link href="/atom.xml"rel="alternate"type="application/atom+xml"><link href="/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="/css/style.css"rel="stylesheet"><link href="/css/post.css"rel="stylesheet"><meta name="generator"content="Hexo 4.2.0"><header id="header-container"><h1 id="blog-title"><a href="/">OS</a></h1><nav><ul class="menu-list"><li class="menu-list-item"><a href="/categories"class="menu-name">categories</a><li class="menu-list-item"><a href="/tags"class="menu-name">tags</a><li class="menu-list-item"><a href="/about"class="menu-name">about</a></ul></nav></header><article class="main"><h1 id="post-title">Docker 安装 ownCloud</h1><div class="post-info"><time class="post-date">2017-12-16</time><ul class="tag-list"><li class="tag-item"><a href="/tags/javascript/"class="tag-name">#javascript</a><li class="tag-item"><a href="/tags/docker/"class="tag-name">#docker</a></ul></div><section class="markdown-body"><h2><a href="#%E5%AE%89%E8%A3%85%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97%E5%8C%85"class="anchor"aria-hidden="true"id="user-content-安装内核模块包"><span class="octicon octicon-link"aria-hidden="true"></span></a>安装内核模块包</h2><div class="highlight highlight-source-shell"><pre>$ sudo apt-get update

$ sudo apt-get install \
    linux-image-extra-<span class="pl-s"><span class="pl-pds">$(</span>uname -r<span class="pl-pds">)</span></span> \
    linux-image-extra-virtual</pre></div><h2><a href="#%E4%BD%BF%E7%94%A8-apt-%E9%95%9C%E5%83%8F%E6%BA%90-%E5%AE%89%E8%A3%85"class="anchor"aria-hidden="true"id="user-content-使用-apt-镜像源-安装"><span class="octicon octicon-link"aria-hidden="true"></span></a>使用 APT 镜像源 安装</h2><h3><a href="#%E6%B7%BB%E5%8A%A0%E4%BD%BF%E7%94%A8-https-%E4%BC%A0%E8%BE%93%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85%E4%BB%A5%E5%8F%8A-ca-%E8%AF%81%E4%B9%A6"class="anchor"aria-hidden="true"id="user-content-添加使用-https-传输的软件包以及-ca-证书"><span class="octicon octicon-link"aria-hidden="true"></span></a>添加使用 HTTPS 传输的软件包以及 CA 证书</h3><div class="highlight highlight-source-shell"><pre>$ sudo apt-get update

$ sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    software-properties-common</pre></div><h3><a href="#%E6%B7%BB%E5%8A%A0%E8%BD%AF%E4%BB%B6%E6%BA%90%E7%9A%84-gpg-%E5%AF%86%E9%92%A5"class="anchor"aria-hidden="true"id="user-content-添加软件源的-gpg-密钥"><span class="octicon octicon-link"aria-hidden="true"></span></a>添加软件源的 GPG 密钥</h3><div class="highlight highlight-source-shell"><pre>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="pl-k">|</span> sudo apt-key add -</pre></div><h3><a href="#%E5%90%91-sourcelist-%E4%B8%AD%E6%B7%BB%E5%8A%A0-docker-%E8%BD%AF%E4%BB%B6%E6%BA%90"class="anchor"aria-hidden="true"id="user-content-向-sourcelist-中添加-docker-软件源"><span class="octicon octicon-link"aria-hidden="true"></span></a>向<code>source.list</code>中添加 Docker 软件源</h3><div class="highlight highlight-source-shell"><pre>$ sudo add-apt-repository \
    <span class="pl-s"><span class="pl-pds">"</span>deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="pl-cce">\</span></span>
<span class="pl-s">    <span class="pl-s"><span class="pl-pds">$(</span>lsb_release -cs<span class="pl-pds">)</span></span> <span class="pl-cce">\</span></span>
<span class="pl-s">    stable<span class="pl-pds">"</span></span></pre></div><h2><a href="#%E5%AE%89%E8%A3%85-docker-ce"class="anchor"aria-hidden="true"id="user-content-安装-docker-ce"><span class="octicon octicon-link"aria-hidden="true"></span></a>安装 Docker CE</h2><p>更新 apt 软件包缓存，并安装<code>docker-ce</code>：<div class="highlight highlight-source-shell"><pre>$ sudo apt-get update

$ sudo apt-get install docker-ce</pre></div><h2><a href="#%E5%90%AF%E5%8A%A8-docker-ce"class="anchor"aria-hidden="true"id="user-content-启动-docker-ce"><span class="octicon octicon-link"aria-hidden="true"></span></a>启动 Docker CE</h2><div class="highlight highlight-source-shell"><pre>$ sudo systemctl <span class="pl-c1">enable</span> docker
$ sudo systemctl start docker</pre></div><h2><a href="#%E6%B5%8B%E8%AF%95-docker-%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E6%AD%A3%E7%A1%AE"class="anchor"aria-hidden="true"id="user-content-测试-docker-是否安装正确"><span class="octicon octicon-link"aria-hidden="true"></span></a>测试 Docker 是否安装正确</h2><div class="highlight highlight-source-shell"><pre>$ docker run hello-world

Unable to find image <span class="pl-s"><span class="pl-pds">'</span>hello-world:latest<span class="pl-pds">'</span></span> locally
......
Hello from Docker<span class="pl-k">!</span> ......
</pre></div><p>有如上输入则代表安装成功<h2><a href="#%E9%85%8D%E7%BD%AE-docker-compose"class="anchor"aria-hidden="true"id="user-content-配置-docker-compose"><span class="octicon octicon-link"aria-hidden="true"></span></a>配置 docker-compose</h2><h3><a href="#%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E7%9A%84docker-compose"class="anchor"aria-hidden="true"id="user-content-下载最新版本的docker-compose"><span class="octicon octicon-link"aria-hidden="true"></span></a>下载最新版本的Docker Compose</h3><div class="highlight highlight-source-shell"><pre>$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-<span class="pl-s"><span class="pl-pds">`</span>uname -s<span class="pl-pds">`</span></span>-<span class="pl-s"><span class="pl-pds">`</span>uname -m<span class="pl-pds">`</span></span> -o /usr/local/bin/docker-compose</pre></div><p><a href="https://github.com/docker/compose/releases"target="_blank"rel="noopener">检查最新版本</a>，版本号自行更改<h3><a href="#%E5%AF%B9%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%BA%94%E7%94%A8%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90"class="anchor"aria-hidden="true"id="user-content-对二进制文件应用可执行权限"><span class="octicon octicon-link"aria-hidden="true"></span></a>对二进制文件应用可执行权限</h3><div class="highlight highlight-source-shell"><pre>$ sudo chmod +x /usr/local/bin/docker-compose</pre></div><h3><a href="#%E6%B5%8B%E8%AF%95"class="anchor"aria-hidden="true"id="user-content-测试"><span class="octicon octicon-link"aria-hidden="true"></span></a>测试</h3><div class="highlight highlight-source-shell"><pre>$ docker-compose --version
docker-compose version 1.17.0, build 1719ceb</pre></div><h3><a href="#%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE-docker-composeyml"class="anchor"aria-hidden="true"id="user-content-编写配置-docker-composeyml"><span class="octicon octicon-link"aria-hidden="true"></span></a>编写配置 docker-compose.yml</h3><div class="highlight highlight-source-yaml"><pre><span class="pl-ent">version</span>: <span class="pl-s"><span class="pl-pds">'</span>2<span class="pl-pds">'</span></span>
<span class="pl-ent">services</span>:
  <span class="pl-ent">owncloud</span>:
    <span class="pl-ent">image</span>: <span class="pl-s">owncloud</span>
    <span class="pl-ent">links</span>:
      - <span class="pl-s">mysql:mysql</span>
    <span class="pl-ent">volumes</span>:
      - <span class="pl-s"><span class="pl-pds">"</span>/data/db/owncloud/data:/var/www/html/data<span class="pl-pds">"</span></span>
      - <span class="pl-s"><span class="pl-pds">"</span>/data/db/owncloud/config:/var/www/html/config<span class="pl-pds">"</span></span>
      - <span class="pl-s"><span class="pl-pds">"</span>/data/db/owncloud/apps:/var/www/html/apps<span class="pl-pds">"</span></span>
    <span class="pl-ent">ports</span>:
      - <span class="pl-c1">8000:80</span>
  <span class="pl-ent">mysql</span>:
    <span class="pl-ent">image</span>: <span class="pl-s">mysql</span>
    <span class="pl-ent">volumes</span>:
      - <span class="pl-s"><span class="pl-pds">"</span>/data/db/mysql:/var/lib/mysql<span class="pl-pds">"</span></span>
    <span class="pl-ent">ports</span>:
      - <span class="pl-c1">3306:3306</span>
    <span class="pl-ent">environment</span>:
      <span class="pl-ent">MYSQL_ROOT_PASSWORD</span>: <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span>
      <span class="pl-ent">MYSQL_DATABASE</span>: <span class="pl-s">ownCloud</span></pre></div><h3><a href="#docker-compose-%E8%BF%90%E8%A1%8C%E5%92%8C%E5%81%9C%E6%AD%A2"class="anchor"aria-hidden="true"id="user-content-docker-compose-运行和停止"><span class="octicon octicon-link"aria-hidden="true"></span></a>docker-compose 运行和停止</h3><p><code>docker-compose</code>必须在<code>docker-compose.yml</code>文件所在目录中执行<div class="highlight highlight-source-shell"><pre>docker-compose 后台启动
$ docker-compose up -d

docker-compose 查看状态
$ docker-compose ps

docker-compose 停止和删除
$ docker-compose stop
$ dcoker-compose rm

相当上面两条命令
$ dcoker-compose down</pre></div><h2><a href="#%E5%90%AF%E5%8A%A8%E5%B9%B6%E9%85%8D%E7%BD%AE-owncloud"class="anchor"aria-hidden="true"id="user-content-启动并配置-owncloud"><span class="octicon octicon-link"aria-hidden="true"></span></a>启动并配置 owncloud</h2><div class="highlight highlight-source-shell"><pre>$ docker-compose up -d</pre></div><p><a href="https://camo.githubusercontent.com/97d31f65e918b52b106ddf81b04805d70ba64301/68747470733a2f2f692e696d6775722e636f6d2f55744775667a582e6a7067"target="_blank"rel="nofollow"><img alt="enter image description here"data-canonical-src="https://i.imgur.com/UtGufzX.jpg"src="https://camo.githubusercontent.com/97d31f65e918b52b106ddf81b04805d70ba64301/68747470733a2f2f692e696d6775722e636f6d2f55744775667a582e6a7067"style="max-width:100%;"></a><blockquote><p>数据库用户：root 数据库密码：password 数据库名：owncloud 数据库主机：mysql</blockquote></section></article><footer class="footer-container"><section>Copyright &copy; 2020&nbsp;<a href="mailto:zowiegong@gmail.com">zowiegong</a>&nbsp;Powered by&nbsp;<a href="https://github.com/hexojs/hexo"target="_blank"rel="noopener noreferrer">Hexo</a>&nbsp;Theme by&nbsp;<a href="https://github.com/zowiegong/hexo-theme-os"target="_blank"rel="noopener noreferrer">OS.</a><br><a href="https://github.com/zowiegong/hexo-blog/edit/master/source/_posts/Docker owncloud.md"target="_blank">Edit source file</a></section></footer><div class="hover-pointer"id="scroll-to-top-container"><svg class="hover-fill"height="3rem "id="scroll-to-top-btn"version="1.1"viewBox="0 0 1024 1024"width="3rem"><path d="M825.568 555.328l-287.392-289.28C531.808 259.648 523.488 256.576 515.2 256.64 514.08 256.544 513.12 256 512 256c-4.672 0-9.024 1.088-13.024 2.88-4.032 1.536-7.872 3.872-11.136 7.136l-259.328 258.88c-12.512 12.48-12.544 32.736-0.032 45.248 6.24 6.272 14.432 9.408 22.656 9.408 8.192 0 16.352-3.136 22.624-9.344L480 364.288 480 928c0 17.696 14.336 32 32 32s32-14.304 32-32L544 362.72l236.192 237.728c6.24 6.272 14.496 9.44 22.688 9.44s16.32-3.104 22.56-9.312C838.016 588.128 838.048 567.84 825.568 555.328z"p-id="1100"></path><path d="M864 192 160 192C142.336 192 128 177.664 128 160s14.336-32 32-32l704 0c17.696 0 32 14.336 32 32S881.696 192 864 192z"p-id="1101"></path></svg></div><script>let pluginsConfig = JSON.parse('{"googleAnalytics":"UA-121105508-1","scrollToTop":true,"scrollSmooth":false,"comments":{"enable":true,"repo":"zowiegong/hexo-blog"}}')</script><script>pluginsConfig.comments.enable = true</script><script src="/js/script.js"></script>